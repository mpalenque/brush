<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Overlay Display</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #000;
            color: #fff;
        }
        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: #007acc;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background: #005a99;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: #333;
        }
        #testCanvas {
            border: 1px solid #666;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <h3>Test Overlay Images</h3>
        <button onclick="testRed()">Test Red</button>
        <button onclick="testBlue()">Test Blue</button>
        <button onclick="testPink()">Test Pink</button>
        <button onclick="testSave()">Test Save</button>
        <div class="status" id="status">Status: Ready</div>
        <div class="status" id="overlayInfo">Overlay: Not loaded</div>
    </div>

    <canvas id="testCanvas" width="800" height="600"></canvas>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const canvas = document.getElementById('testCanvas');
        const ctx = canvas.getContext('2d');
        const statusDiv = document.getElementById('status');
        const overlayInfoDiv = document.getElementById('overlayInfo');
        
        let overlayImg = new Image();
        let overlayLoaded = false;
        
        // Connect to server
        const socket = io();
        
        socket.on('connect', () => {
            statusDiv.textContent = 'Status: Connected to server';
            statusDiv.style.background = '#228b22';
        });
        
        socket.on('disconnect', () => {
            statusDiv.textContent = 'Status: Disconnected';
            statusDiv.style.background = '#dc3545';
        });
        
        overlayImg.onload = () => {
            overlayLoaded = true;
            overlayInfoDiv.textContent = `Overlay: Loaded (${overlayImg.width}x${overlayImg.height})`;
            overlayInfoDiv.style.background = '#228b22';
            drawOverlay();
        };
        
        overlayImg.onerror = () => {
            overlayLoaded = false;
            overlayInfoDiv.textContent = 'Overlay: Failed to load';
            overlayInfoDiv.style.background = '#dc3545';
        };
        
        function drawOverlay() {
            if (!overlayLoaded) return;
            
            ctx.fillStyle = '#f5ddc7';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw some overlay images
            const size = 100;
            for (let y = 0; y < 3; y++) {
                for (let x = 0; x < 4; x++) {
                    const posX = x * 150 + 50;
                    const posY = y * 150 + 50;
                    ctx.drawImage(overlayImg, posX, posY, size, size);
                }
            }
        }
        
        function testRed() {
            overlayLoaded = false;
            overlayInfoDiv.textContent = 'Overlay: Loading red...';
            overlayInfoDiv.style.background = '#666';
            overlayImg.src = '/red.png?t=' + Date.now();
        }
        
        function testBlue() {
            overlayLoaded = false;
            overlayInfoDiv.textContent = 'Overlay: Loading blue...';
            overlayInfoDiv.style.background = '#666';
            overlayImg.src = '/blue.png?t=' + Date.now();
        }
        
        function testPink() {
            overlayLoaded = false;
            overlayInfoDiv.textContent = 'Overlay: Loading pink...';
            overlayInfoDiv.style.background = '#666';
            overlayImg.src = '/pink.png?t=' + Date.now();
        }
        
        function testSave() {
            const imageData = canvas.toDataURL('image/png', 1.0);
            socket.emit('saveScreenCanvas', {
                imageData: imageData,
                screenId: 'test',
                timestamp: Date.now()
            });
            statusDiv.textContent = 'Status: Save test sent to server';
        }
        
        // Load red image by default
        testRed();
    </script>
</body>
</html>
